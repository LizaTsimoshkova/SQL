1)Задание
Посчитать, количество различных книг и количество экземпляров книг каждого автора , хранящихся на складе.  Столбцы назвать Автор, Различных_книг и Количество_экземпляров соответственно.

Решение

SELECT author AS Автор, COUNT(title) AS Различных_книг, SUM(amount) AS Количество_экземпляров
FROM book
GROUP BY author

2)ЗАДАНИЕ
Посчитать стоимость всех экземпляров каждого автора без учета книг «Идиот» и «Белая гвардия». В результат включить только тех авторов, у которых суммарная стоимость книг (без учета книг «Идиот» и «Белая гвардия») более 5000 руб. Вычисляемый столбец назвать Стоимость. Результат отсортировать по убыванию стоимости.


Решение

SELECT author,
       SUM(price*amount) AS Стоимость
FROM book
WHERE title <> "Идиот" AND author <> "Белая гвардия"
GROUP BY author
HAVING SUM(price*amount)>=5000
ORDER BY SUM(price*amount) DESC;

3)ЗАДАНИЕ
Посчитать сколько и каких экземпляров книг нужно заказать поставщикам, чтобы на складе стало одинаковое количество экземпляров каждой книги, равное значению самого большего количества экземпляров одной книги на складе. Вывести название книги, ее автора, текущее количество экземпляров на складе и количество заказываемых экземпляров книг. Последнему столбцу присвоить имя Заказ. В результат не включать книги, которые заказывать не нужно.


Решение

SELECT title, author, amount,
       ((SELECT MAX(amount) FROM book)-amount) AS Заказ
FROM book
WHERE NOT amount=(SELECT MAX(amount) FROM book);